{% extends "base.html" %}

{% set colors = {"GREEN": "#00b400"} %}

{% macro render_cube_side(side, face_suffix) %}
<div class="cube__face cube__face--{{ face_suffix }}">
    <table cellspacing={{ 40 / (cube.get_size() + 1) }}>
        {% for row in side %}
        <tr>
            {% for cell in row %}
            <td bgcolor={{ colors.get(cell.name) or cell.name }}></td>
            {% endfor %}
        </tr>
        {% endfor %}
    </table>
</div>
{% endmacro %}

{% macro render_cube(sides) %}
    <div class="scene">
        <div class="cube">
            {% for name in ["top", "front", "right", "bottom", "back", "left"] %}
            {{ render_cube_side(sides[loop.index - 1], name) }}
            {% endfor %}
        </div>
    </div>
{% endmacro %}

{% block script %}
    <script src={{ url_for("static", filename="script.js") }}></script>
    <noscript>Sorry!</noscript>
{% endblock %}

{% block body %}
    <div class="centered">
        {{ render_cube(cube.get_sides()) }}
        <form class="centered" action="" method="post">
            {{ form.csrf_token }}
            <p class="centered">
                {{ form.sequence.label }}
                {{ form.sequence }}
                {% for error in form.sequence.errors %}
                {{ error }}
                {% endfor %}
            </p>
            <p class="centered">
                {{ form.rotate.label }}
                {{ form.rotate }}
            </p>
            <p class="centered">
                {{ form.apply }}
            </p>
        </form>
        <p>
            {% with messages = get_flashed_messages() %}
                {{ messages[0] if messages else "" }}
            {% endwith %}
        </p>
    </div>
{% endblock %}
